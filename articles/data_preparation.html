<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="datplot">
<title>Data Preparation and Visualization • datplot</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data Preparation and Visualization">
<meta property="og:description" content="datplot">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">datplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_preparation.html">Data Preparation and Visualization</a>
    <a class="dropdown-item" href="../articles/how-to.html">Density Plots for Dates</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lsteinmann/datplot/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Data Preparation and Visualization</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lsteinmann/datplot/blob/HEAD/vignettes/data_preparation.Rmd" class="external-link"><code>vignettes/data_preparation.Rmd</code></a></small>
      <div class="d-none name"><code>data_preparation.Rmd</code></div>
    </div>

    
    
<p>Archaeological data as it can be found “in the wild” rarely conforms
to the formats suitable for any kind of statistical analysis. This
vignette is intended as a way of demonstrating a possibility of data
cleaning on a data set as it can frequently be found in archaeological
literature, or put together during archaeological research. The data is
prepared for use with the <code>datplot</code>-package. An analysis
based on this data can be found as a case study in the paper “datplot: A
new R-Package for the Visualization of Date Ranges in Archaeology” <span class="citation">(Weissova and Steinmann 2021)</span> by the authors of
this package.</p>
<p>The inscriptions of Bithynia data set, that is included in this
package, was compiled for a publication analyzing the settlement
patterns and road systems in ancient Bithynia <span class="citation">(Weissova 2019)</span>. The vignette is thus meant as
guidance for archaeologists looking to employ the <a href="https://github.com/lsteinmann/datplot" class="external-link">datplot-package</a>, and
finding themselves in need of reformatting their data without much
experience in programming languages. It points to certain problems
arising with data sets, which are often incarnated in the form of
spreadsheets. The Bithynia data set is a typical example of the
structure of data as it is used by many (classical) archaeologists. The
process of cleaning it highlights solutions for the issues encountered
with such spreadsheets, and may also be adapted to other data as well as
fields.</p>
<p>First, we attach the packages to be used in the vignette:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lsteinmann/datplot" class="external-link">datplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/ggridges/" class="external-link">ggridges</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="the-inscriptions-of-bithynia-data-set">The “Inscriptions of Bithynia” data set<a class="anchor" aria-label="anchor" href="#the-inscriptions-of-bithynia-data-set"></a>
</h2>
<p>The manually curated data that B. Weissova prepared for her
dissertation was saved as an Excel-spreadsheet. In order to comply with
CRAN, we slightly reformatted it into a csv-file containing only
ASCII-characters. We continue from this file, which is available <a href="https://github.com/lsteinmann/datplot" class="external-link">in this repositories</a>
“inst/extdata/”-sub-directory. It can be loaded into R without further
complications using the <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv()</a></code>-function.</p>
<p><em>Please note:</em> Since the conversion of the original Excel file
to CRAN-compatible ASCII-data this script does not convert all data
anymore. I apologize for not updating this script, but it seems too
irrelevant to spent more time on it than I already have, since the
package contains the clean Data already. I am keeping this as a lesson
that data is complicated, and that things change.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inscriptions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,</span>
<span>                                     <span class="st">"Bithynia_Inscriptions_ascii.csv"</span>,</span>
<span>                                     package <span class="op">=</span> <span class="st">"datplot"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">inscriptions</span><span class="op">)</span></span>
<span><span class="co">#&gt;      ikey             Location            Source          Chronological.Frame</span></span>
<span><span class="co">#&gt;  Length:2878        Length:2878        Length:2878        Length:2878        </span></span>
<span><span class="co">#&gt;  Class :character   Class :character   Class :character   Class :character   </span></span>
<span><span class="co">#&gt;  Mode  :character   Mode  :character   Mode  :character   Mode  :character   </span></span>
<span><span class="co">#&gt;    Language        </span></span>
<span><span class="co">#&gt;  Length:2878       </span></span>
<span><span class="co">#&gt;  Class :character  </span></span>
<span><span class="co">#&gt;  Mode  :character</span></span></code></pre></div>
<p>A large amount of the initial data was provided by the <a href="https://inscriptions.packhum.org/" class="external-link">Searchable Greek Inscriptions
Tool of the Packard Humanities Institute</a> and the <a href="https://edh-www.adw.uni-heidelberg.de/home" class="external-link">Epigraphische
Datenbank Heidelberg</a>. Those inscriptions (n = 0) can be referenced
in the databases with their <code>ikey</code>. The data set was
supplemented with 0 inscriptions that were manually gathered from
different sources. The relevant citations are to be found in the
<code>Source</code> column. Additional information on the creation and
curation of this data set can be found in the publication mentioned
above <span class="citation">(Weissova 2019)</span>.</p>
<p>The original file consists of five columns which each row
representing a single inscription: <code>ikey</code> contains the
reference to the <a href="https://inscriptions.packhum.org/" class="external-link">Searchable
Greek Inscriptions Tool of the Packard Humanities Institute</a>,
indicated via <code>PH</code> as a prefix, or to the <a href="https://edh-www.adw.uni-heidelberg.de/home" class="external-link">Epigraphische
Datenbank Heidelberg</a>, indicated via <code>HD</code> as a prefix.
<code>Location</code> refers to the find spot of the inscription.
<code>Source</code> states the source of the data.
<code>Chronological Frame</code> contains the dating in a verbose
format, such as “Roman Imperial Period”. <code>Language</code> records
the language in which the inscription was written, which can either be
Latin, Greek, or both.</p>
</div>
<div class="section level2">
<h2 id="data-preparation-cleaning-and-reformatting">Data Preparation, Cleaning and Reformatting<a class="anchor" aria-label="anchor" href="#data-preparation-cleaning-and-reformatting"></a>
</h2>
<p>The data set is not yet suited for analysis, as some variables,
especially the chronological frame, have many inconsistencies. For
further processing, we should also be sure to include an
identifier-column. As 331 inscriptions do not have an ikey-Value, which
might have otherwise been a good candidate for identification, we chose
to create a new automatically generated ID, so that every inscription
can be individually identifiable.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inscriptions</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"I_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">inscriptions</span><span class="op">)</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p>Two of the variables of this data set are almost ready for further
use, i.e. Location and Language. A look at their unique values reveals
only small inconsistencies that can be easily fixed:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">inscriptions</span><span class="op">$</span><span class="va">Location</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Apamea"                    "Apollonia ad Rhyndacum"   </span></span>
<span><span class="co">#&gt;  [3] "Caesarea Germanice"        "Chalcedon"                </span></span>
<span><span class="co">#&gt;  [5] "Claudiopolis"              "Creteia Flaviopolis"      </span></span>
<span><span class="co">#&gt;  [7] "Daskyleion"                "Heraclea Pontica"         </span></span>
<span><span class="co">#&gt;  [9] "Heraclea Pontica "         "Juliopolis"               </span></span>
<span><span class="co">#&gt; [11] "Kaisarea Hadrianopolis"    "Nicaea"                   </span></span>
<span><span class="co">#&gt; [13] "Nicaea "                   "Nicomedia"                </span></span>
<span><span class="co">#&gt; [15] "Nicomedia (Dakibyza)"      "Prusias ad Hypium"        </span></span>
<span><span class="co">#&gt; [17] "Prusias ad Mare"           "Prusias ad Mare (Keramed)"</span></span>
<span><span class="co">#&gt; [19] "Prusias ad Olympum"        "Pylai"                    </span></span>
<span><span class="co">#&gt; [21] "Strobilos"                 "Tios"                     </span></span>
<span><span class="co">#&gt; [23] "Tios "                     "unknown"                  </span></span>
<span><span class="co">#&gt; [25] "unknown (Bolu museum)"     "unknown (Lamounia ?)"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">inscriptions</span><span class="op">$</span><span class="va">Language</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Greek"    "Gr/Lat"   "Latin"    "Gr / Lat"</span></span></code></pre></div>
<p>Using functions from the <code>tidyverse</code> package family, we
can easily transform the columns. We rename the “Chronological Frame” to
<code>Dating</code>, as shorter names without spaces are more convenient
to work with, and add proper NA-values if there is no chronological
assessment. With <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code> and <code><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace()</a></code> we
also clear out the redundant variable values from <code>Location</code>
and <code>Language</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inscriptions</span> <span class="op">&lt;-</span> <span class="va">inscriptions</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Dating <span class="op">=</span> <span class="va">Chronological.Frame</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Dating <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html" class="external-link">na_if</a></span><span class="op">(</span><span class="va">Dating</span>, <span class="st">"---"</span><span class="op">)</span>,</span>
<span>         Language <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">Language</span>, <span class="va">Language</span> <span class="op">==</span> <span class="st">"Gr/Lat"</span>, <span class="st">"Greek/Latin"</span><span class="op">)</span>,</span>
<span>         Language <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">Language</span>, <span class="va">Language</span> <span class="op">==</span> <span class="st">"Gr / Lat"</span>, <span class="st">"Greek/Latin"</span><span class="op">)</span>,</span>
<span>         Language <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Language</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Greek"</span>, <span class="st">"Latin"</span>,</span>
<span>                                                <span class="st">"Greek/Latin"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         Location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">Location</span>, <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">Location</span>, <span class="st">"unknown"</span><span class="op">)</span>,</span>
<span>                            <span class="st">"unknown"</span><span class="op">)</span>,</span>
<span>         Location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">Location</span>,</span>
<span>                            <span class="va">Location</span> <span class="op">==</span> <span class="st">"Prusias ad Mare (Keramed)"</span>,</span>
<span>                            <span class="st">"Prusias ad Mare"</span><span class="op">)</span>,</span>
<span>         Location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Location</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This conversion leaves us with a more compact overview of the data
sets contents:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">inscriptions</span><span class="op">)</span></span>
<span><span class="co">#&gt;      ikey                         Location      Source         </span></span>
<span><span class="co">#&gt;  Length:2878        Nicaea            :760   Length:2878       </span></span>
<span><span class="co">#&gt;  Class :character   Nicomedia         :501   Class :character  </span></span>
<span><span class="co">#&gt;  Mode  :character   Prusias ad Olympum:344   Mode  :character  </span></span>
<span><span class="co">#&gt;                     Claudiopolis      :252                     </span></span>
<span><span class="co">#&gt;                     Chalcedon         :200                     </span></span>
<span><span class="co">#&gt;                     Prusias ad Hypium :179                     </span></span>
<span><span class="co">#&gt;                     (Other)           :642                     </span></span>
<span><span class="co">#&gt;     Dating                 Language         ID           </span></span>
<span><span class="co">#&gt;  Length:2878        Greek      :2724   Length:2878       </span></span>
<span><span class="co">#&gt;  Class :character   Latin      : 125   Class :character  </span></span>
<span><span class="co">#&gt;  Mode  :character   Greek/Latin:  29   Mode  :character  </span></span>
<span><span class="co">#&gt;                                                          </span></span>
<span><span class="co">#&gt;                                                          </span></span>
<span><span class="co">#&gt;                                                          </span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<div class="section level3">
<h3 id="cleaning-up-the-dating-variable">Cleaning up the Dating-variable<a class="anchor" aria-label="anchor" href="#cleaning-up-the-dating-variable"></a>
</h3>
<p>Some of the values in the <code>Dating</code>-variable contain
question signs, indicating an uncertainty of the chronological frames
assessment. To keep this information, we store it in a new variable
<code>uncertain_dating</code>, which contains <code>TRUE</code> if there
was a question mark in the original assessment and <code>FALSE</code> if
the dating was certain, so that if one wishes the additional information
could later be used to select or exclude uncertain values.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inscriptions</span><span class="op">$</span><span class="va">uncertain_dating</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"\\?"</span>, <span class="va">inscriptions</span><span class="op">$</span><span class="va">Dating</span><span class="op">)</span></span>
<span><span class="va">inscriptions</span><span class="op">$</span><span class="va">uncertain_dating</span><span class="op">[</span><span class="va">sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">inscriptions</span><span class="op">$</span><span class="va">Dating</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\?"</span>, <span class="st">""</span>, <span class="va">inscriptions</span><span class="op">$</span><span class="va">Dating</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="creating-a-concordance-for-periods">Creating a Concordance for Periods<a class="anchor" aria-label="anchor" href="#creating-a-concordance-for-periods"></a>
</h4>
<p>The next step is sorting out values from the <code>Dating</code>
variable that have to be manually entered, such as the “Roman Imperial
Period”. We achieve this by excluding all values that contain a number,
preparing a table in which we can manually enter the desired dating span
and saving it as a .csv-file. After adding the values manually, we
reload the file. The manually edited concordance can be found in the
“inst/extdata/”-sub-directory <a href="https://github.com/lsteinmann/datplot" class="external-link">of this repository</a> in
the file <code>periods_edit.csv</code> and corresponds with the
chronological assessment of periods used in the original publication
<span class="citation">(Weissova 2019, 42)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"[0-9]"</span>, <span class="va">inscriptions</span><span class="op">$</span><span class="va">Dating</span><span class="op">)</span></span>
<span><span class="va">periods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Dating"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">inscriptions</span><span class="op">$</span><span class="va">Dating</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">sel</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">periods</span><span class="op">$</span><span class="va">DAT_min</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">periods</span><span class="op">$</span><span class="va">DAT_max</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="co">#write.csv(periods, file = "../data-raw/periods.csv", fileEncoding = "UTF-8")</span></span>
<span><span class="co"># .... Manual editing of the resulting table, saving it as "periods_edit.csv".</span></span>
<span><span class="va">join_dating</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'periods_edit.csv'</span>,</span>
<span>                                           package <span class="op">=</span> <span class="st">'datplot'</span>,</span>
<span>                                           mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                        row.names <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                        colClasses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"character"</span>, <span class="st">"character"</span>,</span>
<span>                                       <span class="st">"integer"</span>, <span class="st">"integer"</span><span class="op">)</span>,</span>
<span>                        encoding <span class="op">=</span> <span class="st">"UTF-8"</span><span class="op">)</span></span></code></pre></div>
<p>It is of course possible to add the corresponding values in R. Since
the process could hardly be automated, this way seemed more efficient to
us, though it is - sadly - less transparent in this vignette. The values
can be examined by the reader in the csv-Table mentioned above, or by
loading the table via <code><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file()</a></code> as seen in the code
chunk.</p>
</div>
<div class="section level4">
<h4 id="reformatting-of-partially-numerical-dating-values">Reformatting of Partially Numerical Dating Values<a class="anchor" aria-label="anchor" href="#reformatting-of-partially-numerical-dating-values"></a>
</h4>
<p>There remains, however, a large amount of values that is not covered
in this concordance. We can easily automate some of the conversions as a
series of steps that we store in another <code>data.frame</code> called
<code>num_dating</code>, encompassing all the unique values that contain
some form of a numerical dating.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_dating</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Dating"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">inscriptions</span><span class="op">$</span><span class="va">Dating</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">sel</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_max</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>First, there is a number of inscriptions dated to a single year. We
select these using a regular expression with <code><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep()</a></code><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;For information and guidance on regular expressions see
e.g. &lt;a href="https://regex101.com/" class="external-link"&gt;https://regex101.com/&lt;/a&gt;. However,
R has a slightly different handling of escape characters. Information
can be found in the R-Documentation under &lt;code&gt;&lt;a href="https://stringr.tidyverse.org/reference/modifiers.html" class="external-link"&gt;?regex&lt;/a&gt;&lt;/code&gt; or &lt;a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/regex.html" class="external-link"&gt;here&lt;/a&gt;.&lt;/p&gt;'><sup>1</sup></a> and can
simply delete the character-part of the values so that only the
specified year remains and is stored in both of the
<code>DAT_</code>-variables. We do this separately for AD and BC-values
since BC needs to be stored as a negative number.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^[0-9]{1,3} AD$"</span>, <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">)</span></span>
<span><span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">[</span><span class="va">sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">" AD"</span>, <span class="st">""</span>, <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">[</span><span class="va">sel</span><span class="op">]</span><span class="op">)</span> </span>
<span><span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_max</span><span class="op">[</span><span class="va">sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">" AD"</span>, <span class="st">""</span>, <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">[</span><span class="va">sel</span><span class="op">]</span><span class="op">)</span> </span>
<span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^[0-9]{1,3} BC$"</span>, <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">)</span></span>
<span><span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">[</span><span class="va">sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">" BC"</span>, <span class="st">""</span>, <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">[</span><span class="va">sel</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                                 sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_max</span><span class="op">[</span><span class="va">sel</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"-"</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">" BC"</span>, <span class="st">""</span>, <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">[</span><span class="va">sel</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                                 sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p>As a demonstration, this is the resulting table
(<code>num_dating</code>) of up to this point converted values:</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">Dating</th>
<th align="left">DAT_min</th>
<th align="left">DAT_max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">189</td>
<td align="left">146 AD</td>
<td align="left">146</td>
<td align="left">146</td>
</tr>
<tr class="even">
<td align="left">82</td>
<td align="left">131 AD</td>
<td align="left">131</td>
<td align="left">131</td>
</tr>
<tr class="odd">
<td align="left">229</td>
<td align="left">147 AD</td>
<td align="left">147</td>
<td align="left">147</td>
</tr>
<tr class="even">
<td align="left">31</td>
<td align="left">117 AD</td>
<td align="left">117</td>
<td align="left">117</td>
</tr>
<tr class="odd">
<td align="left">49</td>
<td align="left">450 AD</td>
<td align="left">450</td>
<td align="left">450</td>
</tr>
<tr class="even">
<td align="left">250</td>
<td align="left">215 AD</td>
<td align="left">215</td>
<td align="left">215</td>
</tr>
<tr class="odd">
<td align="left">259</td>
<td align="left">114 AD</td>
<td align="left">114</td>
<td align="left">114</td>
</tr>
<tr class="even">
<td align="left">59</td>
<td align="left">1 BC</td>
<td align="left">-1</td>
<td align="left">-1</td>
</tr>
<tr class="odd">
<td align="left">266</td>
<td align="left">241 BC</td>
<td align="left">-241</td>
<td align="left">-241</td>
</tr>
<tr class="even">
<td align="left">98</td>
<td align="left">400 BC</td>
<td align="left">-400</td>
<td align="left">-400</td>
</tr>
</tbody>
</table>
<p>Since we frequently check the values in <code>num_dating</code> to
look for errors, we append the finished rows to
<code>join_dating</code>, which we later use as a look-up-table for our
data set, and remove the finished rows from <code>num_dating</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">join_dating</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">join_dating</span>, <span class="va">num_dating</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">num_dating</span> <span class="op">&lt;-</span> <span class="va">num_dating</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>We have to convert the <code>Dating</code> variable from
<code>factor</code> to <code>character</code> now, so we can use the
<code><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit()</a></code>-function on the values:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">)</span></span></code></pre></div>
<p>As some of the values are in the format year-year, e.g. “150-160 AD”,
we can easily grab both numbers from the string. To achieve this, we
select all the rows containing the relevant format, then loop over each
of these rows and split the character string along either “-” or spaces,
and later “/”, as we chose to treat values of the format “198/198 AD” as
“197 - 198 AD”. Selecting the numerical values from the resulting list
according to their position gives us the desired values for
<code>DAT_min</code> and <code>DAT_max</code>. We need to do the same
for the BC-values to make sure they return as negative numbers.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Values like: 92-120 AD</span></span>
<span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^[0-9]{1,3}-[0-9]{1,3} AD"</span>, <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="va">sel</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">[</span><span class="va">r</span><span class="op">]</span>, split <span class="op">=</span> <span class="st">"-| "</span><span class="op">)</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">split</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_max</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">split</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Values like: AD 92-120</span></span>
<span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^AD [0-9]{1,3}-[0-9]{1,3}$"</span>, <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="va">sel</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">[</span><span class="va">r</span><span class="op">]</span>, split <span class="op">=</span> <span class="st">"-| "</span><span class="op">)</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">split</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_max</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">split</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Values like: AD 92 - 120</span></span>
<span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^AD [0-9]{1,3} - [0-9]{1,3}"</span>, <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="va">sel</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">[</span><span class="va">r</span><span class="op">]</span>, split <span class="op">=</span> <span class="st">" - | "</span><span class="op">)</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">split</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_max</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">split</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Values like: 198/199 AD</span></span>
<span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^[0-9]{1,3}/[0-9]{1,3} AD"</span>, <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="va">sel</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">[</span><span class="va">r</span><span class="op">]</span>, split <span class="op">=</span> <span class="st">"/| "</span><span class="op">)</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">split</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_max</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">split</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Values like: 525-75 BC</span></span>
<span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^[0-9]{1,3}-[0-9]{1,3} BC"</span>, <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="va">sel</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">[</span><span class="va">r</span><span class="op">]</span>, split <span class="op">=</span> <span class="st">"-| "</span><span class="op">)</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">split</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_max</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">split</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Another look at the data set can help us to check for possible
errors.</p>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">Dating</th>
<th align="left">DAT_min</th>
<th align="left">DAT_max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">262</td>
<td align="left">84-96 AD</td>
<td align="left">84</td>
<td align="left">96</td>
</tr>
<tr class="even">
<td align="left">151</td>
<td align="left">AD 251 - 300</td>
<td align="left">251</td>
<td align="left">300</td>
</tr>
<tr class="odd">
<td align="left">30</td>
<td align="left">128/129 AD</td>
<td align="left">128</td>
<td align="left">129</td>
</tr>
<tr class="even">
<td align="left">206</td>
<td align="left">98/99 AD</td>
<td align="left">98</td>
<td align="left">99</td>
</tr>
<tr class="odd">
<td align="left">277</td>
<td align="left">AD 84 - 96</td>
<td align="left">84</td>
<td align="left">96</td>
</tr>
<tr class="even">
<td align="left">163</td>
<td align="left">379-392 AD</td>
<td align="left">379</td>
<td align="left">392</td>
</tr>
<tr class="odd">
<td align="left">227</td>
<td align="left">155/156 AD</td>
<td align="left">155</td>
<td align="left">156</td>
</tr>
<tr class="even">
<td align="left">245</td>
<td align="left">76-78 AD</td>
<td align="left">76</td>
<td align="left">78</td>
</tr>
<tr class="odd">
<td align="left">176</td>
<td align="left">257/258 AD</td>
<td align="left">257</td>
<td align="left">258</td>
</tr>
<tr class="even">
<td align="left">173</td>
<td align="left">284-305 AD</td>
<td align="left">284</td>
<td align="left">305</td>
</tr>
</tbody>
</table>
<p>Putting aside the finished values again makes it easier to spot
errors in the process:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">join_dating</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">join_dating</span>, <span class="va">num_dating</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">num_dating</span> <span class="op">&lt;-</span> <span class="va">num_dating</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="reformatting-of-inscriptions-dated-to-complete-centuries">Reformatting of Inscriptions Dated to Complete Centuries<a class="anchor" aria-label="anchor" href="#reformatting-of-inscriptions-dated-to-complete-centuries"></a>
</h4>
<p>Next, we separate values that identify complete centuries. As we want
to express the dating in absolute numbers, we convert “1st c. AD” to a
time span ranging from 0 to 99, and “1st c. BC” to -99 to 0
respectively. The regular expression selects all values, where a single
number in the beginning of the string is followed by two letters
(i.e. 2nd, 3rd, 1st) and “c. AD” resp. “c. BC”. We subtract one and
multiply the number by 100 to get the respective boundaries, again
taking care to treat AD and BC differently.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^[0-9]{1}[a-z]{2} c\\. AD$"</span>, <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="va">sel</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">[</span><span class="va">r</span><span class="op">]</span>, split <span class="op">=</span> <span class="st">"[a-z]{2} c\\."</span><span class="op">)</span></span>
<span>  <span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">split</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">split</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_max</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">split</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span> <span class="fl">99</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^[0-9]{1}[a-z]{2} c\\. BC$"</span>, <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="va">sel</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">[</span><span class="va">r</span><span class="op">]</span>, split <span class="op">=</span> <span class="st">"[a-z]{2} c\\."</span><span class="op">)</span></span>
<span>  <span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">split</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">-</span><span class="op">(</span><span class="va">split</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_max</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">-</span><span class="op">(</span><span class="op">(</span><span class="va">split</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">Dating</th>
<th align="left">DAT_min</th>
<th align="left">DAT_max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">16</td>
<td align="left">3rd c. AD</td>
<td align="left">200</td>
<td align="left">299</td>
</tr>
<tr class="even">
<td align="left">25</td>
<td align="left">1st c. BC</td>
<td align="left">-99</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">41</td>
<td align="left">6th c. BC</td>
<td align="left">-599</td>
<td align="left">-500</td>
</tr>
<tr class="even">
<td align="left">15</td>
<td align="left">3rd c. BC</td>
<td align="left">-299</td>
<td align="left">-200</td>
</tr>
<tr class="odd">
<td align="left">18</td>
<td align="left">2nd c. AD</td>
<td align="left">100</td>
<td align="left">199</td>
</tr>
<tr class="even">
<td align="left">116</td>
<td align="left">4th c. AD</td>
<td align="left">300</td>
<td align="left">399</td>
</tr>
<tr class="odd">
<td align="left">17</td>
<td align="left">2nd c. BC</td>
<td align="left">-199</td>
<td align="left">-100</td>
</tr>
<tr class="even">
<td align="left">47</td>
<td align="left">4th c. BC</td>
<td align="left">-399</td>
<td align="left">-300</td>
</tr>
<tr class="odd">
<td align="left">42</td>
<td align="left">6th c. AD</td>
<td align="left">500</td>
<td align="left">599</td>
</tr>
<tr class="even">
<td align="left">11</td>
<td align="left">5th c. AD</td>
<td align="left">400</td>
<td align="left">499</td>
</tr>
</tbody>
</table>
<p>Again, putting aside the finished values makes it easier to spot
errors in further processing:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">join_dating</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">join_dating</span>, <span class="va">num_dating</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">num_dating</span> <span class="op">&lt;-</span> <span class="va">num_dating</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="reformatting-of-imprecise-dating-values">Reformatting of Imprecise Dating Values<a class="anchor" aria-label="anchor" href="#reformatting-of-imprecise-dating-values"></a>
</h4>
<p>For dates that are around a certain value, i.e. of the format “ca.
190 AD”, we are not able to make a more informed decision than guess
about what the researchers providing this assessment had in mind. This
might also change from inscription to inscription. While a closer look
at the individual inscriptions may yield a more sensible estimate, this
seems not feasible as part of the data preparation process. It seems
that in most cases, if the dating can be as precise as a span of around
10 years, researchers tend to emphasize this. Therefore, we decided to
take a total span of 20 years, i.e. 10 years before and 10 years after
the mentioned value, reflecting some uncertainty on the precision and
duration of the estimate. “ca. 190 AD” thus becomes “180–200 AD”, with
the same mechanism for BC in negative values.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^ca\\. [0-9]{1,3} AD$"</span>, <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="va">sel</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">[</span><span class="va">r</span><span class="op">]</span>, split <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span>
<span>  <span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">split</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">split</span> <span class="op">-</span> <span class="fl">10</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_max</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">split</span> <span class="op">+</span> <span class="fl">10</span></span>
<span><span class="op">}</span></span>
<span><span class="va">sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^ca\\. [0-9]{1,3} BC$"</span>, <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="va">sel</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">[</span><span class="va">r</span><span class="op">]</span>, split <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span>
<span>  <span class="va">split</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">split</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">split</span> <span class="op">-</span> <span class="fl">10</span></span>
<span>  <span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_max</span><span class="op">[</span><span class="va">r</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">split</span> <span class="op">+</span> <span class="fl">10</span></span>
<span><span class="op">}</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">Dating</th>
<th align="left">DAT_min</th>
<th align="left">DAT_max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">5</td>
<td align="left">ca. 200 AD</td>
<td align="left">190</td>
<td align="left">210</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">ca. 100 AD</td>
<td align="left">90</td>
<td align="left">110</td>
</tr>
<tr class="odd">
<td align="left">63</td>
<td align="left">ca. 130 AD</td>
<td align="left">120</td>
<td align="left">140</td>
</tr>
<tr class="even">
<td align="left">203</td>
<td align="left">ca. 214 AD</td>
<td align="left">204</td>
<td align="left">224</td>
</tr>
<tr class="odd">
<td align="left">261</td>
<td align="left">ca. 360 BC</td>
<td align="left">-370</td>
<td align="left">-350</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="creating-a-second-concordance-for-verbose-chronological-assessments">Creating a Second Concordance for Verbose Chronological
Assessments<a class="anchor" aria-label="anchor" href="#creating-a-second-concordance-for-verbose-chronological-assessments"></a>
</h4>
<p>Again, saving the finished values in <code>join_dating</code> leaves
us with the list of not yet converted values as seen in
<code>num_dating</code>s <code>Dating</code>-variable.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">join_dating</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">join_dating</span>, <span class="va">num_dating</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">num_dating</span> <span class="op">&lt;-</span> <span class="va">num_dating</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">num_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">num_dating</span><span class="op">$</span><span class="va">Dating</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] "end of the 2nd c. AD"                </span></span>
<span><span class="co">#&gt;  [2] "end of 1st c. BC - beg. of 1st c. AD"</span></span>
<span><span class="co">#&gt;  [3] "end 2nd c. BC"                       </span></span>
<span><span class="co">#&gt;  [4] "early 1st c. AD"                     </span></span>
<span><span class="co">#&gt;  [5] "after 212 AD"                        </span></span>
<span><span class="co">#&gt;  [6] "AD 531"                              </span></span>
<span><span class="co">#&gt;  [7] "5th/6th century AD"                  </span></span>
<span><span class="co">#&gt;  [8] "3rd/4th century AD"                  </span></span>
<span><span class="co">#&gt;  [9] "2nd - 3rd c. AD"                     </span></span>
<span><span class="co">#&gt; [10] "2nd - 1st c. BC"                     </span></span>
<span><span class="co">#&gt; [11] "1st - beg. of the 2nd c. AD"         </span></span>
<span><span class="co">#&gt; [12] "1st - 2nd c. AD"                     </span></span>
<span><span class="co">#&gt; [13] "AD 117-138 "                         </span></span>
<span><span class="co">#&gt; [14] "2nd century AD"                      </span></span>
<span><span class="co">#&gt; [15] "late 3rd - early 2nd c. BC"          </span></span>
<span><span class="co">#&gt; [16] "5th - 6th c. AD"                     </span></span>
<span><span class="co">#&gt; [17] "3rd quarter of the 6th c. BC"        </span></span>
<span><span class="co">#&gt; [18] "3rd - 2nd c. BC"                     </span></span>
<span><span class="co">#&gt; [19] "340/339 BC"                          </span></span>
<span><span class="co">#&gt; [20] "27 BC-14 AD"</span></span></code></pre></div>
<p>Due to the heterogeneous nature of these 101 values, we decided to
convert them manually again. Our criteria for translating terms like
“beginning of” are the following: “beginning of”, “end of”, “early”,
“late” are – similarly to ca. – all translated to 20 years, as we assume
that more information would have been given if the time span was greater
than a quarter century. For the other values, we employed the same
criteria as seen above in the automated process. We decided to measure
the ‘beginning of a century’ at e.g. -199 for BC values and 100 for AD
values, and accordingly identify the ‘end of a century’ with the values
e.g. -100 (BC) / 199 (AD). Since the data is epigraphical, in the case
of “before” or “after” (i.e. terminus ante/post quem) dates, we assume
some connection to a datable event, and therefore add or subtract a span
of 10 years, which is, however, still rather arbitrary.</p>
<p>As the last step, we switch the – in some cases automatically
assigned – year 0, so that it will be treated as either 1 or -1:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">join_dating</span><span class="op">$</span><span class="va">DAT_min</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">join_dating</span><span class="op">$</span><span class="va">DAT_min</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">join_dating</span><span class="op">$</span><span class="va">DAT_max</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">join_dating</span><span class="op">$</span><span class="va">DAT_max</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span></span></code></pre></div>
<p>We then have to reload the corrected data. The values that we put
aside in the <code>join_dating</code> <code>data.frame</code> beforehand
serve as the basis for our new <code>data.frame</code> that we use as a
look-up table. As the variables were treated as character-strings, we
need to convert them to a numeric format first. We append the newly
loaded manually assigned values to this data.frame. Again, to keep this
process as transparent as possible, we included the *.csv-Table in the
“inst/extdata/” sub-directory as “num_dating_edit.csv”.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#write.csv(num_dating, file = "../data-raw/num_dating.csv", </span></span>
<span><span class="co">#          fileEncoding = "UTF-8")</span></span>
<span><span class="va">num_dating</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'num_dating_edit.csv'</span>,</span>
<span>                                          package <span class="op">=</span> <span class="st">'datplot'</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>                       encoding <span class="op">=</span> <span class="st">"UTF-8"</span>,</span>
<span>                       row.names <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                       colClasses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"character"</span>, <span class="st">"character"</span>,</span>
<span>                                      <span class="st">"integer"</span>, <span class="st">"integer"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">join_dating</span> <span class="op">&lt;-</span> <span class="va">join_dating</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>DAT_min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">DAT_min</span><span class="op">)</span>,</span>
<span>         DAT_max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">DAT_max</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">num_dating</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="joining-the-reformatted-data-with-the-original-data-set">Joining the Reformatted Data with the Original Data Set<a class="anchor" aria-label="anchor" href="#joining-the-reformatted-data-with-the-original-data-set"></a>
</h3>
<p><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join()</a></code> lets us add the <code>DAT_</code>-variables
from the look-up table <code>join_dating</code> to our original
data.frame.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inscriptions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">inscriptions</span>, <span class="va">join_dating</span>, by <span class="op">=</span> <span class="st">"Dating"</span><span class="op">)</span></span></code></pre></div>
<p>The <code>DAT_</code>-variables – as we can now see – contain the
desired information:</p>
<table class="table">
<colgroup>
<col width="6%">
<col width="9%">
<col width="31%">
<col width="29%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">ID</th>
<th align="left">Location</th>
<th align="left">Dating</th>
<th align="right">DAT_min</th>
<th align="right">DAT_max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">628</td>
<td align="left">I_628</td>
<td align="left">Heraclea Pontica</td>
<td align="left">end of the 1st c. AD</td>
<td align="right">80</td>
<td align="right">99</td>
</tr>
<tr class="even">
<td align="left">1699</td>
<td align="left">I_1699</td>
<td align="left">Nicomedia</td>
<td align="left">286-305 AD</td>
<td align="right">286</td>
<td align="right">305</td>
</tr>
<tr class="odd">
<td align="left">1666</td>
<td align="left">I_1666</td>
<td align="left">Nicomedia</td>
<td align="left">AD 150 - 200</td>
<td align="right">150</td>
<td align="right">200</td>
</tr>
<tr class="even">
<td align="left">1739</td>
<td align="left">I_1739</td>
<td align="left">Nicomedia</td>
<td align="left">122/123-126/127 AD</td>
<td align="right">122</td>
<td align="right">127</td>
</tr>
<tr class="odd">
<td align="left">1278</td>
<td align="left">I_1278</td>
<td align="left">Nicaea</td>
<td align="left">2nd century AD</td>
<td align="right">100</td>
<td align="right">199</td>
</tr>
<tr class="even">
<td align="left">1422</td>
<td align="left">I_1422</td>
<td align="left">Nicaea</td>
<td align="left">1st c. BC</td>
<td align="right">-99</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="left">794</td>
<td align="left">I_794</td>
<td align="left">Kaisarea Hadrianopolis</td>
<td align="left">223 AD</td>
<td align="right">223</td>
<td align="right">223</td>
</tr>
<tr class="even">
<td align="left">2189</td>
<td align="left">I_2189</td>
<td align="left">Prusias ad Hypium</td>
<td align="left">219-221 AD</td>
<td align="right">219</td>
<td align="right">221</td>
</tr>
<tr class="odd">
<td align="left">1665</td>
<td align="left">I_1665</td>
<td align="left">Nicomedia</td>
<td align="left">after 138 AD</td>
<td align="right">138</td>
<td align="right">148</td>
</tr>
<tr class="even">
<td align="left">1376</td>
<td align="left">I_1376</td>
<td align="left">Nicaea</td>
<td align="left">2nd - 3rd c. AD</td>
<td align="right">100</td>
<td align="right">299</td>
</tr>
<tr class="odd">
<td align="left">1747</td>
<td align="left">I_1747</td>
<td align="left">Nicomedia</td>
<td align="left">116 AD</td>
<td align="right">116</td>
<td align="right">116</td>
</tr>
<tr class="even">
<td align="left">638</td>
<td align="left">I_638</td>
<td align="left">Heraclea Pontica</td>
<td align="left">2nd c. AD</td>
<td align="right">100</td>
<td align="right">199</td>
</tr>
<tr class="odd">
<td align="left">2810</td>
<td align="left">I_2810</td>
<td align="left">Strobilos</td>
<td align="left">Roman Imp. period</td>
<td align="right">-31</td>
<td align="right">395</td>
</tr>
<tr class="even">
<td align="left">2322</td>
<td align="left">I_2322</td>
<td align="left">Prusias ad Mare</td>
<td align="left">Roman Imp. period</td>
<td align="right">-31</td>
<td align="right">395</td>
</tr>
<tr class="odd">
<td align="left">2158</td>
<td align="left">I_2158</td>
<td align="left">Prusias ad Hypium</td>
<td align="left">after 212 AD</td>
<td align="right">212</td>
<td align="right">222</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="fixing-mistakes">Fixing mistakes<a class="anchor" aria-label="anchor" href="#fixing-mistakes"></a>
</h3>
<p>We can now make a ‘test run’ using datplot with the stepsize-value
set to 5 in order to save as much time as possible<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Using different stepsizes is a bit of an artifact left
over from a less efficient version of datplot, where is processing would
take more than a minute if stepsize was set to 1, so I would usually
start out with 100 or 25 just to look for errors and problems and to not
lose much time. This, however, is technically not necessary in any way.
The function now works faster, though there is a lot of room for
improvement, as it may still take several seconds or longer, but
generally not several minutes. We determined that the feature might
still be useful, and therefore it was not removed.&lt;/p&gt;"><sup>2</sup></a> and check for errors
first. We have to select exactly 4 columns in the correct order of:
Identifier, Grouping Variable, Minimum Dating, Maximum Dating. We
transform the output from the pipe operator to a <code>data.frame</code>
before handing it to <code>datstepts()</code>, as
<strong>datplot</strong> needs this format.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inscr_steps</span> <span class="op">&lt;-</span> <span class="va">inscriptions</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">Location</span>, <span class="va">DAT_min</span>, <span class="va">DAT_max</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">datplot</span><span class="fu">::</span><span class="fu"><a href="../reference/datsteps.html">datsteps</a></span><span class="op">(</span>stepsize <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using 'weight'-calculation (see https://doi.org/10.1017/aap.2021.8).</span></span>
<span><span class="co">#&gt; Warning in switch.dating(DAT_df): Warning: Dating seems to be in wrong order at</span></span>
<span><span class="co">#&gt; ID I_1162, I_2725 (Index: 634, 1451). Dates have been switched, but be sure to</span></span>
<span><span class="co">#&gt; check your original data for possible mistakes.</span></span>
<span><span class="co">#&gt; DAT_min and DAT_max at Index: 60, 75, 138, 196, 211, 266, 331, 332, 344, 345, 622, 625, 727, 873, 877, 878, 930, 933, 935, 936, 939, 943, 981, 982, 1016, 1017, 1022, 1023, 1040, 1041, 1042, 1046, 1047, 1051, 1053, 1108, 1166, 1179, 1182, 1249, 1492, 1493, 1495, 1507, 1508, 1509 have the same value! Is this correct? If unsure, check your data for possible errors.</span></span>
<span><span class="co">#&gt; Warning in create.sub.objects(DAT_list, stepsize, calc, cumulative): stepsize</span></span>
<span><span class="co">#&gt; is larger than the range of the closest dated object at Index = 40, 44, 45, 60,</span></span>
<span><span class="co">#&gt; 75, 76, 77, 110, 123, 128, 129, 130, 138, 144, 151, 168, 193, 195, 196, 198,</span></span>
<span><span class="co">#&gt; 200, 201, 202, 211, 215, 237, 239, 240, 266, 289, 290, 320, 330, 331, 332, 333,</span></span>
<span><span class="co">#&gt; 334, 335, 336, 337, 338, 340, 343, 344, 345, 346, 347, 348, 351, 352, 353, 622,</span></span>
<span><span class="co">#&gt; 624, 625, 637, 643, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733,</span></span>
<span><span class="co">#&gt; 873, 875, 876, 877, 878, 879, 880, 882, 883, 884, 886, 887, 929, 930, 933, 934,</span></span>
<span><span class="co">#&gt; 935, 936, 937, 938, 939, 940, 941, 942, 943, 949, 950, 951, 981, 982, 1010,</span></span>
<span><span class="co">#&gt; 1016, 1017, 1018, 1019, 1020, 1021, 1022, 1023, 1025, 1028, 1029, 1030, 1031,</span></span>
<span><span class="co">#&gt; 1038, 1040, 1041, 1042, 1043, 1044, 1045, 1046, 1047, 1051, 1053, 1054, 1059,</span></span>
<span><span class="co">#&gt; 1060, 1100, 1106, 1108, 1109, 1110, 1111, 1114, 1115, 1120, 1122, 1127, 1148,</span></span>
<span><span class="co">#&gt; 1166, 1168, 1169, 1177, 1179, 1182, 1248, 1249, 1253, 1449, 1473, 1480, 1487,</span></span>
<span><span class="co">#&gt; 1491, 1492, 1493, 1495, 1507, 1508, 1509). This is not recommended. For</span></span>
<span><span class="co">#&gt; information see documentation of get.step.sequence().</span></span></code></pre></div>
<p>There are indeed problems in the data. The first of the three
warnings issued by <code><a href="../reference/datsteps.html">datsteps()</a></code> informs us that we may have
assigned some values wrong: “Warning: Dating seems to be in wrong order
at ID I_1162, I_2725 (Index: 637, 1458). Dates have been switched, but
be sure to check your original data for possible mistakes.” If dates are
in the wrong order, <strong>datplot</strong> will automatically switch
them before proceeding. This, however, might not always be the correct
way of handling the situation, as other errors might have occurred as
well. Therefore, we should check the data again using the Index-Values
or IDs provided by datplots warning:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inscriptions</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">Location</span>, <span class="va">Dating</span>, <span class="va">uncertain_dating</span>, <span class="va">DAT_min</span>, <span class="va">DAT_max</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">637</span>, <span class="fl">1458</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="10%">
<col width="27%">
<col width="15%">
<col width="24%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left">ID</th>
<th align="left">Location</th>
<th align="left">Dating</th>
<th align="left">uncertain_dating</th>
<th align="right">DAT_min</th>
<th align="right">DAT_max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">I_1165</td>
<td align="left">Nicaea</td>
<td align="left">58 AD</td>
<td align="left">FALSE</td>
<td align="right">58</td>
<td align="right">58</td>
</tr>
<tr class="even">
<td align="left">I_2732</td>
<td align="left">Prusias ad Olympum</td>
<td align="left">117-138 AD</td>
<td align="left">FALSE</td>
<td align="right">117</td>
<td align="right">138</td>
</tr>
</tbody>
</table>
<p>The problem here is twofold. In the first entry, our automated
translation of the dating could not handle the format “62/3” and thus
returned a wrong value for <code>DAT_max</code>. If we had a truly large
data set, we should correct this in the original reformatting process.
In this case, it is more efficient to fix this problem right now in the
fastest possible way.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inscriptions</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">inscriptions</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="st">"I_1162"</span><span class="op">)</span>,<span class="st">"DAT_max"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">63</span></span></code></pre></div>
<p>In the other case, the Dating-column provided the BC-values in the
wrong order. We can also fix this quickly right here, which is basically
the same way <strong>datplot</strong> would handle both cases
internally:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inscriptions</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">inscriptions</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="st">"I_2725"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DAT_min"</span>, <span class="st">"DAT_max"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">inscriptions</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">inscriptions</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="st">"I_2725"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DAT_max"</span>, <span class="st">"DAT_min"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Note that <code><a href="../reference/datsteps.html">datsteps()</a></code> changes the date and proceeds, but
warns you of the possibility of errors. It is therefore recommended to
check the data mentioned in that warning. As we ‘fixed’ our data set, we
should save it again, so that the same error will not occur twice:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#write.table(inscriptions, file = "../data-raw/inscriptions.csv", </span></span>
<span><span class="co">#            fileEncoding = "UTF-8", sep = ";", row.names = FALSE)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="storing-the-prepared-data-set">Storing the Prepared Data Set<a class="anchor" aria-label="anchor" href="#storing-the-prepared-data-set"></a>
</h3>
<p>For later use and publication, we add explanations of the variables
and metadata to the R-object and store them in the *.rda file. As a
backup, we also save the finished table as a .csv-file, suitable for
archiving. The .csv-Table, however, does not contain the additional
information added as attributes.</p>
<p>All files are available <a href="https://github.com/lsteinmann/datplot" class="external-link">in this repository</a> and
as part of this package for further use by other researchers. We kindly
ask you to cite <span class="citation">Weissova (2019)</span>, the
Packard Humanities Institute and this repository at <a href="https://github.com/lsteinmann/datplot" class="external-link">https://github.com/lsteinmann/datplot</a>
as sources.</p>
<p>The dataset can be loaded into R by simply calling</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#library(datplot)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Inscr_Bithynia"</span><span class="op">)</span></span></code></pre></div>
<p>when <code>datplot</code> is loaded.</p>
</div>
</div>
<div class="section level2">
<h2 id="selecting-the-data-for-further-analysis-and-using-datplot">Selecting the Data for Further Analysis and using datplot<a class="anchor" aria-label="anchor" href="#selecting-the-data-for-further-analysis-and-using-datplot"></a>
</h2>
<p>As our aim is to get an overview of the spatio-temporal distribution
of the inscriptions in Bithynia, we can only analyze inscriptions with
known Location and Dating. Thus, we have to remove all the rows from the
data set that do not contain this information.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inscr_clean</span> <span class="op">&lt;-</span> <span class="va">Inscr_Bithynia</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Dating</span> <span class="op">!=</span> <span class="st">"NA"</span>,</span>
<span>         <span class="va">Location</span> <span class="op">!=</span> <span class="st">"unknown"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This means that we removed a total of 1380 rows, which did not
contain the information needed. The data set suitable for the analysis
can be summarized as follows:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">inscr_clean</span><span class="op">)</span></span>
<span><span class="co">#&gt;       ID                ikey                             Location  </span></span>
<span><span class="co">#&gt;  Length:1498        Length:1498        Nicaea                :603  </span></span>
<span><span class="co">#&gt;  Class :character   Class :character   Prusias ad Olympum    :279  </span></span>
<span><span class="co">#&gt;  Mode  :character   Mode  :character   Nicomedia             :108  </span></span>
<span><span class="co">#&gt;                                        Kaisarea Hadrianopolis: 87  </span></span>
<span><span class="co">#&gt;                                        Apamea                : 77  </span></span>
<span><span class="co">#&gt;                                        Chalcedon             : 69  </span></span>
<span><span class="co">#&gt;                                        (Other)               :275  </span></span>
<span><span class="co">#&gt;     Source             Dating                 Language    uncertain_dating</span></span>
<span><span class="co">#&gt;  Length:1498        Length:1498        Greek      :1392   Mode :logical   </span></span>
<span><span class="co">#&gt;  Class :character   Class :character   Latin      :  82   FALSE:1327      </span></span>
<span><span class="co">#&gt;  Mode  :character   Mode  :character   Greek/Latin:  24   TRUE :171       </span></span>
<span><span class="co">#&gt;                                                                           </span></span>
<span><span class="co">#&gt;                                                                           </span></span>
<span><span class="co">#&gt;                                                                           </span></span>
<span><span class="co">#&gt;                                                                           </span></span>
<span><span class="co">#&gt;     DAT_min          DAT_max         URL           </span></span>
<span><span class="co">#&gt;  Min.   :-599.0   Min.   :-525   Length:1498       </span></span>
<span><span class="co">#&gt;  1st Qu.: -31.0   1st Qu.: 199   Class :character  </span></span>
<span><span class="co">#&gt;  Median : 100.0   Median : 253   Mode  :character  </span></span>
<span><span class="co">#&gt;  Mean   : 103.1   Mean   : 289                     </span></span>
<span><span class="co">#&gt;  3rd Qu.: 200.0   3rd Qu.: 395                     </span></span>
<span><span class="co">#&gt;  Max.   : 680.0   Max.   : 799                     </span></span>
<span><span class="co">#&gt;  NA's   :192      NA's   :192</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="datplot">datplot<a class="anchor" aria-label="anchor" href="#datplot"></a>
</h2>
<p>We can now begin using the <strong>datplot</strong>-package…</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lsteinmann/datplot" class="external-link">datplot</a></span><span class="op">)</span></span></code></pre></div>
<p>…and can actually try to use <code><a href="../reference/datsteps.html">datsteps()</a></code>, first with a
<code>stepsize</code> of 25 years:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inscr_steps</span> <span class="op">&lt;-</span> <span class="va">inscr_clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">Location</span>, <span class="va">DAT_min</span>, <span class="va">DAT_max</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">datplot</span><span class="fu">::</span><span class="fu"><a href="../reference/datsteps.html">datsteps</a></span><span class="op">(</span>stepsize <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">datplot</span><span class="fu">::</span><span class="fu"><a href="../reference/scaleweight.html">scaleweight</a></span><span class="op">(</span>var <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using 'weight'-calculation (see https://doi.org/10.1017/aap.2021.8).</span></span>
<span><span class="co">#&gt; Warning in datplot::datsteps(., stepsize = 25): 192 rows with NA-values in the</span></span>
<span><span class="co">#&gt; dating columns will be omitted.</span></span>
<span><span class="co">#&gt; DAT_min and DAT_max at Index: 57, 68, 120, 173, 187, 238, 299, 300, 311, 312, 588, 590, 599, 679, 794, 798, 799, 828, 831, 833, 834, 837, 841, 878, 879, 908, 909, 914, 915, 931, 932, 933, 937, 938, 941, 942, 997, 1051, 1064, 1067, 1130, 1304, 1305, 1306 have the same value! Is this correct? If unsure, check your data for possible errors.</span></span>
<span><span class="co">#&gt; Warning in create.sub.objects(DAT_list, stepsize, calc, cumulative): stepsize</span></span>
<span><span class="co">#&gt; is larger than the range of the closest dated object at Index = 6, 12, 13, 17,</span></span>
<span><span class="co">#&gt; 18, 19, 20, 21, 38, 39, 40, 43, 44, 57, 67, 68, 69, 70, 72, 75, 98, 101, 102,</span></span>
<span><span class="co">#&gt; 106, 107, 112, 113, 114, 120, 122, 123, 129, 136, 137, 138, 142, 143, 146, 148,</span></span>
<span><span class="co">#&gt; 149, 150, 168, 170, 172, 173, 175, 177, 178, 179, 180, 181, 182, 186, 187, 189,</span></span>
<span><span class="co">#&gt; 190, 195, 203, 204, 205, 206, 207, 208, 209, 210, 212, 214, 215, 216, 217, 218,</span></span>
<span><span class="co">#&gt; 234, 238, 240, 241, 242, 245, 261, 262, 292, 293, 296, 297, 298, 299, 300, 301,</span></span>
<span><span class="co">#&gt; 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317,</span></span>
<span><span class="co">#&gt; 318, 319, 320, 543, 546, 547, 548, 549, 581, 582, 583, 584, 585, 586, 588, 590,</span></span>
<span><span class="co">#&gt; 591, 592, 593, 594, 595, 596, 597, 599, 602, 606, 672, 673, 674, 675, 676, 677,</span></span>
<span><span class="co">#&gt; 678, 679, 680, 681, 682, 683, 684, 685, 788, 789, 790, 791, 792, 793, 794, 795,</span></span>
<span><span class="co">#&gt; 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 827, 828, 830,</span></span>
<span><span class="co">#&gt; 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846,</span></span>
<span><span class="co">#&gt; 847, 848, 849, 850, 866, 867, 870, 871, 872, 873, 874, 875, 878, 879, 880, 890,</span></span>
<span><span class="co">#&gt; 902, 903, 904, 905, 906, 907, 908, 909, 910, 911, 912, 913, 914, 915, 916, 917,</span></span>
<span><span class="co">#&gt; 918, 919, 920, 921, 922, 923, 924, 929, 930, 931, 932, 933, 934, 935, 936, 937,</span></span>
<span><span class="co">#&gt; 938, 939, 940, 941, 942, 943, 944, 945, 946, 947, 948, 949, 957, 958, 961, 962,</span></span>
<span><span class="co">#&gt; 963, 964, 965, 966, 967, 968, 969, 970, 989, 990, 995, 996, 997, 998, 999,</span></span>
<span><span class="co">#&gt; 1000, 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1008, 1009, 1010, 1011, 1012,</span></span>
<span><span class="co">#&gt; 1013, 1014, 1015, 1016, 1029, 1030, 1031, 1035, 1036, 1051, 1053, 1054, 1055,</span></span>
<span><span class="co">#&gt; 1062, 1064, 1065, 1066, 1067, 1093, 1094, 1095, 1096, 1097, 1098, 1099, 1122,</span></span>
<span><span class="co">#&gt; 1124, 1125, 1126, 1127, 1129, 1130, 1133, 1225, 1267, 1268, 1269, 1270, 1271,</span></span>
<span><span class="co">#&gt; 1272, 1273, 1274, 1275, 1276, 1277, 1278, 1290, 1297, 1302, 1304, 1305, 1306).</span></span>
<span><span class="co">#&gt; This is not recommended. For information see documentation of</span></span>
<span><span class="co">#&gt; get.step.sequence().</span></span></code></pre></div>
<p><code><a href="../reference/datsteps.html">datsteps()</a></code> tells us that a number or objects are dated
to one year, asking us if this is correct. We included this output to
avoid errors occurring through faulty values, as objects dated to one
year have a very high impact on the outcome. It might help to spot
problems or discrepancies in datasets as well, as the warning about the
order of dating above has already shown.</p>
<p>In a second step, we scale the weights according to our grouping
variable (Location), so that the sum of weights in each group equals 1,
which is important for displaying the weight correctly in a density
plot.</p>
</div>
<div class="section level2">
<h2 id="visualizing-the-output-of-datsteps">Visualizing the Output of <code>datsteps()</code><a class="anchor" aria-label="anchor" href="#visualizing-the-output-of-datsteps"></a>
</h2>
<p>To get a general impression of the data set and the possibilities of
visualization, we explore and recommend different plot methods below.
The simplest and fastest way to plot the output with base R is the
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function in combination with the
<code><a href="https://rdrr.io/r/stats/density.html" class="external-link">density()</a></code> function:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">inscr_steps</span><span class="op">$</span><span class="va">DAT_step</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="data_preparation_files/figure-html/unnamed-chunk-38-1.png" width="672"></p>
<div class="section level3">
<h3 id="using-ggplot2">Using <code>ggplot2</code><a class="anchor" aria-label="anchor" href="#using-ggplot2"></a>
</h3>
<p>A somewhat crowded overview containing the Locations of all
Inscriptions can easily be achieved when using <code>ggplot2</code> and
its <code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density()</a></code>-method, which is based on the same
procedure as the <code><a href="https://rdrr.io/r/stats/density.html" class="external-link">density()</a></code>-function used above. A result
may look like this:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">inscr_steps</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DAT_step</span>, fill <span class="op">=</span> <span class="va">variable</span>,</span>
<span>                               weight <span class="op">=</span> <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span></code></pre></div>
<p><img src="data_preparation_files/figure-html/unnamed-chunk-39-1.png" width="672"></p>
<p>Note that the output without the weights calculated by
<code><a href="../reference/datsteps.html">datsteps()</a></code> is very different:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">inscr_steps</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DAT_step</span>, fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></code></pre></div>
<p><img src="data_preparation_files/figure-html/unnamed-chunk-40-1.png" width="672"></p>
<p>The weights calculated by <strong>datplot</strong> (internally using
the <code><a href="../reference/get.weights.html">get.weights()</a></code>-function) are a way of assigning an
importance to the objects in question. They relate to the range an
object is dated to (more detailed information on the process is
available in <span class="citation">(Weissova and Steinmann
2021)</span>). Therefore, any objects dated to large time spans as for
example “Roman Imperial Period” ranging from 31 BC to 395 AD in our data
set, are contributing to the curve significantly less than any object
dated to one exact year. At times it can be very useful to look at both
outputs and discuss them separately. We will look at a case study of a
single city later on to clarify this.</p>
</div>
<div class="section level3">
<h3 id="using-ggplot2-and-ggridges">Using <code>ggplot2</code> and <code>ggridges</code><a class="anchor" aria-label="anchor" href="#using-ggplot2-and-ggridges"></a>
</h3>
<p>Since the graph is very crowded in this layout, we actually recommend
using <code>geom_density_ridges</code> from the
<code>ggridges</code>-package. Since the package has no built in support
for assigning weight, we have to use <code>stat = "density"</code>,
which will reference the <code><a href="https://rdrr.io/r/stats/density.html" class="external-link">density()</a></code>-function to get the
appropriate calculations:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">inscr_steps</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DAT_step</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           fill <span class="op">=</span> <span class="va">variable</span>,</span>
<span>           weight <span class="op">=</span> <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/ggridges/reference/geom_density_ridges.html" class="external-link">geom_density_ridges</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                      stat <span class="op">=</span> <span class="st">"density"</span>, alpha <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_fill_discrete</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span><span class="co">#&gt; Warning: The `guide` argument in `scale_*()` cannot be `FALSE`. This was deprecated in</span></span>
<span><span class="co">#&gt; ggplot2 3.3.4.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use "none" instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span></code></pre></div>
<p><img src="data_preparation_files/figure-html/unnamed-chunk-41-1.png" width="672">
Styling will help to make the plots more readable:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bluegreen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#8dae25"</span>, <span class="st">"#17365c"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">inscr_steps</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DAT_step</span>,</span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           fill <span class="op">=</span> <span class="va">variable</span>,</span>
<span>           weight <span class="op">=</span> <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://wilkelab.org/ggridges/reference/geom_density_ridges.html" class="external-link">geom_density_ridges</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"density"</span>, alpha <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">800</span>, to <span class="op">=</span> <span class="fl">800</span>, by <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">800</span>,<span class="fl">800</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>        panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>                                          color <span class="op">=</span> <span class="st">"gray30"</span><span class="op">)</span>,</span>
<span>        panel.grid.minor.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"dotted"</span>,</span>
<span>                                          color <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>guide<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                    values <span class="op">=</span> <span class="fu">bluegreen</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">inscr_steps</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Epigraphic Evidence from Bithynia"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Spatio-temporal distribution"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"administrative centres"</span>,</span>
<span>       caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">inscriptions</span><span class="op">)</span><span class="op">$</span><span class="va">source</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span></code></pre></div>
<p><img src="data_preparation_files/figure-html/unnamed-chunk-42-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="using-ggplot2-and-facet_wrap">Using <code>ggplot2</code> and <code>facet_wrap()</code><a class="anchor" aria-label="anchor" href="#using-ggplot2-and-facet_wrap"></a>
</h3>
<p>Another option is to separate the variables with
<code>facet_wrap</code>, which is not as condensed and does not support
the option to scale the densities in the graph for maximum visibility,
as <code><a href="https://wilkelab.org/ggridges/reference/geom_density_ridges.html" class="external-link">geom_density_ridges()</a></code> automatically does (see
Documentation of <code>ggridges</code>). In our case, this leads to a
worse visibility of smaller density curves:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">inscr_steps</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DAT_step</span>, </span>
<span>                               fill <span class="op">=</span> <span class="va">variable</span>, weight <span class="op">=</span> <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_fill_discrete</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">~</span> <span class="va">.</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span></code></pre></div>
<p><img src="data_preparation_files/figure-html/unnamed-chunk-43-1.png" width="672"></p>
<p>Styling also helps very much to improve the graphs readability:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">inscr_steps</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DAT_step</span>,</span>
<span>                               fill <span class="op">=</span> <span class="va">variable</span>, weight <span class="op">=</span> <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>guide<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                    values <span class="op">=</span> <span class="fu">bluegreen</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">inscr_steps</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">800</span>, to <span class="op">=</span> <span class="fl">800</span>, by <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">800</span>,<span class="fl">800</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">~</span> <span class="va">.</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">8</span><span class="op">)</span>,</span>
<span>        strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>        axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>                                          color <span class="op">=</span> <span class="st">"gray30"</span><span class="op">)</span>,</span>
<span>        panel.grid.minor.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"dotted"</span>,</span>
<span>                                          color <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Epigraphic Evidence from Bithynia"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Spatio-temporal distribution"</span>,</span>
<span>       caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">inscriptions</span><span class="op">)</span><span class="op">$</span><span class="va">source</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span>
<span></span>
<span><span class="co">#&gt; Warning in density.default(x, weights = w, bw = bw, adjust = adjust, kernel =</span></span>
<span><span class="co">#&gt; kernel, : Selecting bandwidth *not* using 'weights'</span></span></code></pre></div>
<p><img src="data_preparation_files/figure-html/unnamed-chunk-44-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="how-does-datplot-and-kernel-density-estimation-perform-compared-to-histograms">How Does Datplot and Kernel Density Estimation Perform Compared to
Histograms?<a class="anchor" aria-label="anchor" href="#how-does-datplot-and-kernel-density-estimation-perform-compared-to-histograms"></a>
</h2>
<p>In order to compare this output to generally more common
visualizations, we can prepare a histogram of the original data. Here we
have two possible approaches. We first prepare a two-part histogram for
the upper and lower boundaries of the respective dating for each object.
We select only three locations to keep the visualization short:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inscr_clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">Location</span>, <span class="va">DAT_min</span>, <span class="va">DAT_max</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Location</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Prusias ad Hypium"</span>, <span class="st">"Nicomedia"</span>, <span class="st">"Apamea"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span>id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Location"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">25</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">Location</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Dated Inscriptions in Bithynia (selection)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Dating"</span>, y <span class="op">=</span> <span class="st">"Number of Inscriptions"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: attributes are not identical across measure variables; they will be</span></span>
<span><span class="co">#&gt; dropped</span></span>
<span><span class="co">#&gt; Warning: Removed 30 rows containing non-finite values (`stat_bin()`).</span></span></code></pre></div>
<p><img src="data_preparation_files/figure-html/unnamed-chunk-45-1.png" width="672"></p>
<p>Alternatively, we could display the mean of the Dating range:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inscr_clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/transmute.html" class="external-link">transmute</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">Location</span>, <span class="va">Language</span>, DAT_mean <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">DAT_min</span> <span class="op">+</span> <span class="va">DAT_max</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Location</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Prusias ad Hypium"</span>, <span class="st">"Nicomedia"</span>, <span class="st">"Apamea"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span>id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Location"</span>, <span class="st">"Language"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">Language</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">Location</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Dated Inscriptions in Bithynia (selection)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Dating"</span>, y <span class="op">=</span> <span class="st">"Number of Inscriptions"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 15 rows containing non-finite values (`stat_bin()`).</span></span></code></pre></div>
<p><img src="data_preparation_files/figure-html/unnamed-chunk-46-1.png" width="672"></p>
<p>While this also gives us an impression of the distribution, it seems
some information got lost on the way. Many inscriptions were dated to
large time spans, and those have now been gathered into their mean
value. The upside is that the histograms show the real count of
inscriptions, which density graphs cannot.</p>
<p>We have shown in this vignette, how a data set as it is often
encountered by archaeologists can be prepared and formatted in order to
be processed by datplot. Furthermore, we have made some suggestions on
visualization. This vignette hopes to help researchers that are not yet
very familiar with the processes of data cleaning to solutions for their
own projects.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-weissova2019" class="csl-entry">
Weissova, Barbora. 2019. <span>“Regional Economy, Settlement Patterns
and the Road System in <span>Bithynia</span> (4th Century
<span>BC</span> - 6th Century <span>AD</span>). <span>Spatial</span> and
<span>Quantitative Analysis</span>.”</span> Dissertation,
<span>Berlin</span>: <span>Freie Universität Berlin</span>. <a href="https://refubium.fu-berlin.de/handle/fub188/23730" class="external-link">https://refubium.fu-berlin.de/handle/fub188/23730</a>.
</div>
<div id="ref-datplotarticle" class="csl-entry">
Weissova, Barbora, and Lisa Steinmann. 2021. <span>“Datplot:
<span>A</span> New r-Package for the Visualization of Date Ranges in
Archaeology.”</span> <em>Advances in Archaeological Practice</em> 9 (7):
288–98. <a href="https://doi.org/10.1017/aap.2021.8" class="external-link">https://doi.org/10.1017/aap.2021.8</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Lisa Steinmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
